

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/background/%E5%9B%BE%E6%A0%87.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="文晋">
  <meta name="keywords" content="">
  
    <meta name="description" content=".tyvueudwmxvb{}   模型结构：   参考项目：OSU-NLP-Group&#x2F;HippoRAG 安装123conda create -n hipporag python&#x3D;3.10conda activate hipporagpip install hipporag  下载数据集：huggingface-cli download --repo-type dataset">
<meta property="og:type" content="article">
<meta property="og:title" content="【论文复现】HippoRAG &amp; HippoRAG2">
<meta property="og:url" content="http://xuan-van.github.io/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/index.html">
<meta property="og:site_name" content="文心晋意">
<meta property="og:description" content=".tyvueudwmxvb{}   模型结构：   参考项目：OSU-NLP-Group&#x2F;HippoRAG 安装123conda create -n hipporag python&#x3D;3.10conda activate hipporagpip install hipporag  下载数据集：huggingface-cli download --repo-type dataset">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://xuan-van.github.io/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/1.png">
<meta property="og:image" content="http://xuan-van.github.io/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/2.jpg">
<meta property="og:image" content="http://xuan-van.github.io/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/3.png">
<meta property="article:published_time" content="2025-03-27T04:00:00.000Z">
<meta property="article:modified_time" content="2025-04-11T02:18:53.718Z">
<meta property="article:author" content="文晋">
<meta property="article:tag" content="RAG">
<meta property="article:tag" content="LLM">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://xuan-van.github.io/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/1.png">
  
  
  
  <title>【论文复现】HippoRAG &amp; HippoRAG2 - 文心晋意</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/background/background.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"xuan-van.github.io","root":"/","version":"1.9.8","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":3},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>文晋的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-image"></i>
                <span>图片</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/images/llama.svg" target="_self">
                    
                    <span>Llama 结构</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">【论文复现】HippoRAG & HippoRAG2</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-03-27 12:00" pubdate>
          2025年3月27日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.2k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          19 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="代码复现"
        id="heading-211acd8e7f189296b7caddd5c95b71af" role="tab" data-toggle="collapse" href="#collapse-211acd8e7f189296b7caddd5c95b71af"
        aria-expanded="true"
      >
        代码复现
        <span class="list-group-count">(6)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-211acd8e7f189296b7caddd5c95b71af"
           role="tabpanel" aria-labelledby="heading-211acd8e7f189296b7caddd5c95b71af">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E4%BB%A3%E7%A0%81%E6%8B%86%E8%A7%A3%E3%80%91trajectory-transformer/" title="【代码拆解】Trajectory Transformer"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">【代码拆解】Trajectory Transformer</span>
        </a>
      
    
      
      
        <a href="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87%E3%80%91%E5%B8%B8%E7%94%A8%E9%97%AE%E7%AD%94%E6%95%B0%E6%8D%AE%E9%9B%86/" title="【数据准备】常用问答数据集"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">【数据准备】常用问答数据集</span>
        </a>
      
    
      
      
        <a href="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E6%A8%A1%E5%9E%8B%E5%A4%8D%E7%8E%B0%E3%80%91%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0-llama3/" title="【模型复现】从零实现 Llama3"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">【模型复现】从零实现 Llama3</span>
        </a>
      
    
      
      
        <a href="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/" title="【论文复现】HippoRAG &amp; HippoRAG2"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">【论文复现】HippoRAG &amp; HippoRAG2</span>
        </a>
      
    
      
      
        <a href="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91instructrag/" title="【论文复现】InstructRAG"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">【论文复现】InstructRAG</span>
        </a>
      
    
      
      
        <a href="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91selfrag/" title="【论文复现】SelfRAG"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">【论文复现】SelfRAG</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">【论文复现】HippoRAG &amp; HippoRAG2</h1>
            
            
              <div class="markdown-body">
                
                <figure style="text-align: center;">
    <style>.tyvueudwmxvb{}</style><img src="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/1.png" srcset="/img/loading.gif" lazyload class="tyvueudwmxvb">
</figure>

<p>模型结构：</p>
<img src="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/2.jpg" srcset="/img/loading.gif" lazyload class="">

<p>参考项目：<a target="_blank" rel="noopener" href="https://github.com/OSU-NLP-Group/HippoRAG">OSU-NLP-Group&#x2F;HippoRAG</a></p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda create -n hipporag python=3.10<br>conda activate hipporag<br>pip install hipporag<br></code></pre></td></tr></table></figure>

<p>下载数据集：<code>huggingface-cli download --repo-type dataset osunlp/HippoRAG_2 --local-dir dataset</code></p>
<p>下载 Embedding 模型（NV-Embed, GritLM, Contriever）：<code>huggingface-cli download nvidia/NV-Embed-v2 --local-dir model/NV-Embed-v2</code></p>
<p>下载 LLM：<code>huggingface-cli download nreHieW/Llama-3.1-8B-Instruct --local-dir model/Llama-3.1-8B-Instruct</code></p>
<h1 id="start-py"><a href="#start-py" class="headerlink" title="start.py"></a>start.py</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hipporag <span class="hljs-keyword">import</span> HippoRAG<br><span class="hljs-keyword">import</span> argparse<br><br>docs = [<br>    <span class="hljs-string">&quot;Oliver Badman is a politician.&quot;</span>,<br>    <span class="hljs-string">&quot;George Rankin is a politician.&quot;</span>,<br>    <span class="hljs-string">&quot;Thomas Marwick is a politician.&quot;</span>,<br>    <span class="hljs-string">&quot;Cinderella attended the royal ball.&quot;</span>,<br>    <span class="hljs-string">&quot;The prince used the lost glass slipper to search the kingdom.&quot;</span>,<br>    <span class="hljs-string">&quot;When the slipper fit perfectly, Cinderella was reunited with the prince.&quot;</span>,<br>    <span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span>,<br>    <span class="hljs-string">&quot;Marina is bom in Minsk.&quot;</span>,<br>    <span class="hljs-string">&quot;Montebello is a part of Rockland County.&quot;</span><br>]<br><br>parser = argparse.ArgumentParser(description=<span class="hljs-string">&quot;HippoRAG retrieval and QA&quot;</span>)<br>parser.add_argument(<span class="hljs-string">&#x27;mode&#x27;</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">str</span>, choices=[<span class="hljs-string">&#x27;online&#x27;</span>, <span class="hljs-string">&#x27;offline&#x27;</span>], <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Mode&#x27;</span>)<br>args = parser.parse_args()<br><br><span class="hljs-keyword">if</span> args.mode == <span class="hljs-string">&#x27;online&#x27;</span>:<br>    llm_model_name, llm_base_url = <span class="hljs-string">&#x27;deepseek-r1&#x27;</span>, <span class="hljs-string">&#x27;https://dashscope.aliyuncs.com/compatible-mode/v1&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    llm_model_name, llm_base_url = <span class="hljs-string">&#x27;model/Llama-3.1-8B-Instruct&#x27;</span>, <span class="hljs-string">&#x27;http://localhost:8000/v1&#x27;</span><br><br>save_dir = <span class="hljs-string">f&#x27;outputs/<span class="hljs-subst">&#123;args.mode&#125;</span>&#x27;</span><br>embedding_model_name = <span class="hljs-string">&#x27;model/NV-Embed-v2&#x27;</span><br><br>hipporag = HippoRAG(save_dir=save_dir,<br>                    llm_model_name=llm_model_name,<br>                    llm_base_url=llm_base_url,<br>                    embedding_model_name=embedding_model_name)<br><br>hipporag.index(docs=docs)<br><br>queries = [<br>    <span class="hljs-string">&quot;What is George Rankin&#x27;s occupation?&quot;</span>,<br>    <span class="hljs-string">&quot;How did Cinderella reach her happy ending?&quot;</span>,<br>    <span class="hljs-string">&quot;What county is Erik Hort&#x27;s birthplace a part of?&quot;</span><br>]<br><br><span class="hljs-comment"># QuerySolution: question, docs(2), doc_scores(2)</span><br>retrieval_results = hipporag.retrieve(queries=queries, num_to_retrieve=<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Retrieval results: <span class="hljs-subst">&#123;retrieval_results&#125;</span>&#x27;</span>)<br><br><span class="hljs-comment"># QuerySolution: question, docs(2), doc_scores(2), answer; Predict_Answer; Tokens: prompt_tokens, completion_tokens, finish_reason</span><br>qa_results = hipporag.rag_qa(retrieval_results)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;QA results: <span class="hljs-subst">&#123;qa_results&#125;</span>&#x27;</span>)<br><br><span class="hljs-comment"># QuerySolution: question, docs, doc_scores, answer; Predict_Answer; Tokens: prompt_tokens, completion_tokens, finish_reason</span><br>rag_results = hipporag.rag_qa(queries=queries)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;RAG QA results: <span class="hljs-subst">&#123;rag_results&#125;</span>&#x27;</span>)<br><br>answers = [<br>    [<span class="hljs-string">&quot;Politician&quot;</span>],<br>    [<span class="hljs-string">&quot;By going to the ball.&quot;</span>],<br>    [<span class="hljs-string">&quot;Rockland County&quot;</span>]<br>]<br><br>gold_docs = [<br>    [<span class="hljs-string">&quot;George Rankin is a politician.&quot;</span>],<br>    [<span class="hljs-string">&quot;Cinderella attended the royal ball.&quot;</span>,<br>    <span class="hljs-string">&quot;The prince used the lost glass slipper to search the kingdom.&quot;</span>,<br>    <span class="hljs-string">&quot;When the slipper fit perfectly, Cinderella was reunited with the prince.&quot;</span>],<br>    [<span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span>,<br>    <span class="hljs-string">&quot;Montebello is a part of Rockland County.&quot;</span>]<br>]<br><br><span class="hljs-comment"># QuerySolution: question, docs, doc_scores, answer; Predict_Answer; Tokens: prompt_tokens, completion_tokens, finish_reason; Recall: Recall@1, Recall@2, Recall@5, Recall@10, Recall@20, Recall@30, Recall@50, Recall@100, Recall@150, Recall@200; Evaluation: ExactMatch, F1</span><br>rag_results = hipporag.rag_qa(queries=queries, gold_docs=gold_docs, gold_answers=answers)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;RAG QA results: <span class="hljs-subst">&#123;rag_results&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>执行流程：</p>
<pre><code class=" mermaid">graph TD
    A[&quot;载入大模型（Loading checkpoint shards）&quot;] --&gt; B[&quot;实体识别（NER）&quot;]
    B --&gt; C[&quot;提取三元组（Extractin triples）&quot;]
    C --&gt; D[&quot;（Batch Encoding）KNN for Queries&quot;]
    D --&gt; E[Retrieving]
    E --&gt; F[Collecting QA prompts]
    F --&gt; G[QA Reading]
    G --&gt; H[Extraction Answers from LLM Response]
</code></pre>

<p>生成内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$&#123;llm_model_name&#125;</span>_<span class="hljs-variable">$&#123;embedding_model_name&#125;</span>/<br>    chunk_embeddings/vdb_chunk.parquet<br>    entity_embeddings/vdb_chunk.parquet<br>    fact_embeddings/vdb_chunk.parquet<br>    graph.graphml<br>    <br>llm_cache/<br>    <span class="hljs-variable">$&#123;llm_model_name&#125;</span>_cache.sqlite<br>    <span class="hljs-variable">$&#123;llm_model_name&#125;</span>_cache.sqlite.lock<br>    <br>openie_results_ner_<span class="hljs-variable">$&#123;llm_model_name&#125;</span>.json<br></code></pre></td></tr></table></figure>

<p><code>openie_results_ner_$&#123;llm_model_name&#125;.json</code> 结构：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-string">&quot;docs&quot;</span>：<span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;idx&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;段落标识符&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;passage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;段落&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;extracted_entities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;实体&quot;</span><span class="hljs-punctuation">,</span> ...<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;extracted_triples&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-string">&quot;三元组&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> ...<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        ...   <br>    <span class="hljs-punctuation">]</span>   <br>    <span class="hljs-attr">&quot;avg_ent_chars&quot;</span><span class="hljs-punctuation">:</span> 所有提取实体的平均字符数<span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;avg_ent_words&quot;</span><span class="hljs-punctuation">:</span> 所有提取实体的平均字符数<br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h1 id="调用-API"><a href="#调用-API" class="headerlink" title="调用 API"></a>调用 API</h1><p>调用阿里云百炼的 <a target="_blank" rel="noopener" href="https://bailian.console.aliyun.com/#/model-market/detail/deepseek-r1">DeepSeek-R1 API</a>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">export OPENAI_API_KEY=<span class="hljs-string">&quot;Your API Key&quot;</span><br>conda activate hipporag<br>python start.py online<br></code></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    &#x27;num_phrase_nodes&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">17</span><span class="hljs-punctuation">,</span> <br>    &#x27;num_passage_nodes&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span> <br>    &#x27;num_total_nodes&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">26</span><span class="hljs-punctuation">,</span> <br>    &#x27;num_extracted_triples&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">13</span><span class="hljs-punctuation">,</span> <br>    &#x27;num_triples_with_passage_node&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">22</span><span class="hljs-punctuation">,</span> <br>    &#x27;num_synonymy_triples&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span> <br>    &#x27;num_total_triples&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<br/>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json">Retrieval results<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    QuerySolution(<br>        question=<span class="hljs-string">&quot;What is George Rankin&#x27;s occupation?&quot;</span><span class="hljs-punctuation">,</span> <br>        docs=<span class="hljs-punctuation">[</span>&#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>        doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.10445492</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.02884537</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> <br>        answer=None<span class="hljs-punctuation">,</span> <br>        gold_answers=None<span class="hljs-punctuation">,</span> <br>        gold_docs=None<br>    )<span class="hljs-punctuation">,</span><br>    QuerySolution(<br>        question=&#x27;How did Cinderella reach her happy ending?&#x27;<span class="hljs-punctuation">,</span> <br>        docs=<span class="hljs-punctuation">[</span>&#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>        doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.04911817</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.04404111</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> <br>        answer=None<span class="hljs-punctuation">,</span> <br>        gold_answers=None<span class="hljs-punctuation">,</span> <br>        gold_docs=None<br>    )<span class="hljs-punctuation">,</span><br>    QuerySolution(<br>        question=<span class="hljs-string">&quot;What county is Erik Hort&#x27;s birthplace a part of?&quot;</span><span class="hljs-punctuation">,</span> <br>        docs=<span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>        doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.09849677</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.05840253</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> <br>        answer=None<span class="hljs-punctuation">,</span> <br>        gold_answers=None<span class="hljs-punctuation">,</span> <br>        gold_docs=None<br>    )<br><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>
<br/>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs json">QA results<span class="hljs-punctuation">:</span> (<br>    <span class="hljs-punctuation">[</span><br>        QuerySolution(question=<span class="hljs-string">&quot;What is George Rankin&#x27;s occupation?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.10445492</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.02884537</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;politician.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<span class="hljs-punctuation">,</span><br>        QuerySolution(question=&#x27;How did Cinderella reach her happy ending?&#x27;<span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.04911817</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.04404111</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;Cinderella reached her happy ending when her glass slipper fit perfectly<span class="hljs-punctuation">,</span> leading the prince to reunite with and marry her.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<span class="hljs-punctuation">,</span><br>        QuerySolution(question=<span class="hljs-string">&quot;What county is Erik Hort&#x27;s birthplace a part of?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.09849677</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.05840253</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;Rockland County.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">[</span><br>        &#x27;Answer<span class="hljs-punctuation">:</span> politician.&#x27;<span class="hljs-punctuation">,</span> <br>        &#x27;Answer<span class="hljs-punctuation">:</span> Cinderella reached her happy ending when her glass slipper fit perfectly<span class="hljs-punctuation">,</span> leading the prince to reunite with and marry her.&#x27;<span class="hljs-punctuation">,</span> <br>        &#x27;Answer<span class="hljs-punctuation">:</span> Rockland County.&#x27;<br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">703</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">135</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">712</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">284</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">712</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">166</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>)<br></code></pre></td></tr></table></figure>
<br/>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs json">RAG QA results<span class="hljs-punctuation">:</span> (<br>    <span class="hljs-punctuation">[</span><br>        QuerySolution(question=<span class="hljs-string">&quot;What is George Rankin&#x27;s occupation?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">1.04454916e-01</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.88453687e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.86224239e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.37302870e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.60382181e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.54294019e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.37682343e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.12725136e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.00820154e-05</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;politician.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<span class="hljs-punctuation">,</span><br>        QuerySolution(question=&#x27;How did Cinderella reach her happy ending?&#x27;<span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">4.91181658e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.40411111e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3.13502299e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">9.84442137e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.19267052e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.06979324e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.93263127e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.93737401e-05</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.09027597e-05</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;The prince found her using the glass slipper that fit her perfectly.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<span class="hljs-punctuation">,</span><br>        QuerySolution(question=<span class="hljs-string">&quot;What county is Erik Hort&#x27;s birthplace a part of?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> &#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">9.84967740e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5.84025250e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.67207424e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.66319251e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.45981989e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.28462349e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3.96527292e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.85392503e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">7.33911131e-06</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;Rockland County.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">[</span><br>        &#x27;Answer<span class="hljs-punctuation">:</span> politician.&#x27;<span class="hljs-punctuation">,</span><br>        &#x27;Thought<span class="hljs-punctuation">:</span> Cinderella reached her happy ending by having the prince search for her using the glass slipper she lost at the royal ball. When the slipper fit her perfectly<span class="hljs-punctuation">,</span> they were reunited.  \nAnswer<span class="hljs-punctuation">:</span> The prince found her using the glass slipper that fit her perfectly.&#x27;<span class="hljs-punctuation">,</span> <br>        &#x27;Answer<span class="hljs-punctuation">:</span> Rockland County.&#x27;<br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">737</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">99</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">752</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">240</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">748</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">203</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>)<br></code></pre></td></tr></table></figure>
<br/>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs json">RAG QA results<span class="hljs-punctuation">:</span> (<br>    <span class="hljs-punctuation">[</span><br>        QuerySolution(question=<span class="hljs-string">&quot;What is George Rankin&#x27;s occupation?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">1.04454916e-01</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.88453687e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.86224239e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.37302870e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.60382181e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.54294019e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.37682343e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.12725136e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.00820154e-05</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;politician.&#x27;<span class="hljs-punctuation">,</span> gold_answers=<span class="hljs-punctuation">[</span>&#x27;Politician&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> gold_docs=<span class="hljs-punctuation">[</span>&#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> <br>        QuerySolution(question=&#x27;How did Cinderella reach her happy ending?&#x27;<span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">4.91181658e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.40411111e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3.13502299e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">9.84442137e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.19267052e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.06979324e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.93263127e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.93737401e-05</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.09027597e-05</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;The prince found her using the glass slipper that fit her perfectly.&#x27;<span class="hljs-punctuation">,</span> gold_answers=<span class="hljs-punctuation">[</span>&#x27;By going to the ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> gold_docs=<span class="hljs-punctuation">[</span>&#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> <br>        QuerySolution(question=<span class="hljs-string">&quot;What county is Erik Hort&#x27;s birthplace a part of?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> &#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">9.84967740e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5.84025250e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.67207424e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.66319251e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.45981989e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.28462349e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3.96527292e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.85392503e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">7.33911131e-06</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;Rockland County.&#x27;<span class="hljs-punctuation">,</span> gold_answers=<span class="hljs-punctuation">[</span>&#x27;Rockland County&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> gold_docs=<span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">]</span>)<br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">[</span><br>        &#x27;Answer<span class="hljs-punctuation">:</span> politician.&#x27;<span class="hljs-punctuation">,</span><br>        &#x27;Thought<span class="hljs-punctuation">:</span> Cinderella reached her happy ending by having the prince search for her using the glass slipper she lost at the royal ball. When the slipper fit her perfectly<span class="hljs-punctuation">,</span> they were reunited.  \nAnswer<span class="hljs-punctuation">:</span> The prince found her using the glass slipper that fit her perfectly.&#x27;<span class="hljs-punctuation">,</span> <br>        &#x27;Answer<span class="hljs-punctuation">:</span> Rockland County.&#x27;<br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">737</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">99</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">752</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">240</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">748</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">203</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">&#123;</span>&#x27;Recall@<span class="hljs-number">1</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.6111</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">2</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.8889</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">5</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">10</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">20</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">30</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">50</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">100</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">150</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">200</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">&#123;</span>&#x27;ExactMatch&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.6667</span><span class="hljs-punctuation">,</span> &#x27;F1&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.6667</span><span class="hljs-punctuation">&#125;</span><br>)<br></code></pre></td></tr></table></figure>

<h1 id="vllm-本地部署"><a href="#vllm-本地部署" class="headerlink" title="vllm 本地部署"></a>vllm 本地部署</h1><p>如果发生 OOM（out of memory），调整 <code>gpu-memory-utilization</code> 或 <code>max_model_len</code> 以适应 GPU 内存：<code>vllm serve model/Llama-3.1-8B-Instruct --tensor-parallel-size 2 --max_model_len 4096 --gpu-memory-utilization 0.95 --dtype half</code></p>
<p>运行：<code>python start.py offline</code></p>
<p>输出：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>&#x27;num_phrase_nodes&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">16</span><span class="hljs-punctuation">,</span> &#x27;num_passage_nodes&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span> &#x27;num_total_nodes&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span> &#x27;num_extracted_triples&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">13</span><span class="hljs-punctuation">,</span> &#x27;num_triples_with_passage_node&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span> &#x27;num_synonymy_triples&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">13</span><span class="hljs-punctuation">,</span> &#x27;num_total_triples&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">46</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>打印的结构类似，因此只展示 2 个结果：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs json">QA results<span class="hljs-punctuation">:</span> (<br>    <span class="hljs-punctuation">[</span><br>        QuerySolution(question=<span class="hljs-string">&quot;What is George Rankin&#x27;s occupation?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.10445492</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.02884537</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;Politician.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<span class="hljs-punctuation">,</span> <br>        QuerySolution(question=&#x27;How did Cinderella reach her happy ending?&#x27;<span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.04447086</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.04025739</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;She attended the royal ball and was reunited with the prince after the slipper fit perfectly.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<span class="hljs-punctuation">,</span> <br>        QuerySolution(question=<span class="hljs-string">&quot;What county is Erik Hort&#x27;s birthplace a part of?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">0.09898717</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.05803498</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;Rockland County.&#x27;<span class="hljs-punctuation">,</span> gold_answers=None<span class="hljs-punctuation">,</span> gold_docs=None)<br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">[</span><br>        <span class="hljs-string">&quot;The text does not provide information about George Rankin&#x27;s occupation. However, it is mentioned that Thomas Marwick is a politician, and George Rankin is also mentioned as a politician in the Wikipedia title. \nAnswer: Politician.&quot;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-string">&quot;The provided text snippets do not contain information about Cinderella&#x27;s journey to her happy ending. However, based on general knowledge of the Cinderella fairy tale, it is likely that Cinderella reached her happy ending by attending the royal ball, where she met the prince, and then being reunited with him after the slipper fit perfectly.\n\nAnswer: She attended the royal ball and was reunited with the prince after the slipper fit perfectly.&quot;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-string">&quot;To determine the county Erik Hort&#x27;s birthplace is a part of, we need to identify the birthplace as Montebello, and then find the county that Montebello is a part of. According to the text, Montebello is a part of Rockland County. \nAnswer: Rockland County.&quot;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">733</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">48</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">742</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">87</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">744</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">64</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>)<br></code></pre></td></tr></table></figure>
<br/>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs json">RAG QA results<span class="hljs-punctuation">:</span> (<br>    <span class="hljs-punctuation">[</span><br>        QuerySolution(question=<span class="hljs-string">&quot;What is George Rankin&#x27;s occupation?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">1.04454916e-01</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.88453687e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.86224239e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.37302870e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.60382181e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.54294019e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.40683217e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.07797284e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.29945501e-05</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;Politician.&#x27;<span class="hljs-punctuation">,</span> gold_answers=<span class="hljs-punctuation">[</span>&#x27;Politician&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> gold_docs=<span class="hljs-punctuation">[</span>&#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> <br>        QuerySolution(question=&#x27;How did Cinderella reach her happy ending?&#x27;<span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span>&#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">4.44708555e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.02573902e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.10223824e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">9.48902014e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.04130761e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3.92286642e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.82675803e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.75912597e-05</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.01481327e-05</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;By attending the royal ball and the prince searching for her using the lost glass slipper.&#x27;<span class="hljs-punctuation">,</span> gold_answers=<span class="hljs-punctuation">[</span>&#x27;By going to the ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> gold_docs=<span class="hljs-punctuation">[</span>&#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> <br>        QuerySolution(question=<span class="hljs-string">&quot;What county is Erik Hort&#x27;s birthplace a part of?&quot;</span><span class="hljs-punctuation">,</span> docs=<span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">,</span> &#x27;Marina is bom in Minsk.&#x27;<span class="hljs-punctuation">,</span> &#x27;George Rankin is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;The prince used the lost glass slipper to search the kingdom.&#x27;<span class="hljs-punctuation">,</span> &#x27;Thomas Marwick is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;Oliver Badman is a politician.&#x27;<span class="hljs-punctuation">,</span> &#x27;When the slipper fit perfectly<span class="hljs-punctuation">,</span> Cinderella was reunited with the prince.&#x27;<span class="hljs-punctuation">,</span> &#x27;Cinderella attended the royal ball.&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> doc_scores=array(<span class="hljs-punctuation">[</span><span class="hljs-number">9.89871677e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5.80349811e-02</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.69545125e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.67774318e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.51392444e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.29586220e-03</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3.99996366e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.57814418e-04</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4.49168290e-06</span><span class="hljs-punctuation">]</span>)<span class="hljs-punctuation">,</span> answer=&#x27;Rockland County.&#x27;<span class="hljs-punctuation">,</span> gold_answers=<span class="hljs-punctuation">[</span>&#x27;Rockland County&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> gold_docs=<span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Erik Hort&#x27;s birthplace is Montebello.&quot;</span><span class="hljs-punctuation">,</span> &#x27;Montebello is a part of Rockland County.&#x27;<span class="hljs-punctuation">]</span>)<br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">[</span><br>        <span class="hljs-string">&quot;To determine George Rankin&#x27;s occupation, we need to analyze the given information. The Wikipedia titles provided do not directly mention George Rankin&#x27;s occupation. However, the fact that there are Wikipedia titles for George Rankin, Thomas Marwick, and Oliver Badman, all of which are politicians, suggests that George Rankin is also a politician.\n\nAnswer: Politician.&quot;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-string">&quot;To answer this question, we need to analyze the given information. However, the provided Wikipedia titles do not directly mention Cinderella&#x27;s journey to her happy ending. They only provide brief summaries of Cinderella&#x27;s story.\n\nThe first title mentions Cinderella being reunited with the prince when the slipper fit perfectly, but it doesn&#x27;t explain how she reached that point. The second title mentions Cinderella attending the royal ball, but it doesn&#x27;t provide any context. The third title mentions the prince using the lost glass slipper to search the kingdom, which is a crucial part of the Cinderella story.\n\nSince the provided information is incomplete, we can&#x27;t directly answer the question. However, based on the general knowledge of the Cinderella story, we can infer that Cinderella reached her happy ending by attending the royal ball, losing a glass slipper, and the prince searching for her using the slipper.\n\nAnswer: By attending the royal ball and the prince searching for her using the lost glass slipper.&quot;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-string">&quot;To answer this question, we need to find the connection between Erik Hort&#x27;s birthplace and the county. We know that Erik Hort&#x27;s birthplace is Montebello, and Montebello is a part of Rockland County.\n\nTherefore, we can conclude that Erik Hort&#x27;s birthplace is a part of Rockland County.\nAnswer: Rockland County.&quot;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">770</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">75</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">785</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">201</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>        <span class="hljs-punctuation">&#123;</span>&#x27;prompt_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">783</span><span class="hljs-punctuation">,</span> &#x27;completion_tokens&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">72</span><span class="hljs-punctuation">,</span> &#x27;finish_reason&#x27;<span class="hljs-punctuation">:</span> &#x27;stop&#x27;<span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">&#123;</span>&#x27;Recall@<span class="hljs-number">1</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.6111</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">2</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.8889</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">5</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">10</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">20</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">30</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">50</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">100</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">150</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span> &#x27;Recall@<span class="hljs-number">200</span>&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>    <span class="hljs-punctuation">&#123;</span>&#x27;ExactMatch&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.6667</span><span class="hljs-punctuation">,</span> &#x27;F1&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.7451</span><span class="hljs-punctuation">&#125;</span><br>)<br></code></pre></td></tr></table></figure>

<h1 id="绘制-graphml"><a href="#绘制-graphml" class="headerlink" title="绘制 graphml"></a>绘制 graphml</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> networkx <span class="hljs-keyword">as</span> nx<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 读取GraphML文件</span><br>G = nx.read_graphml(<span class="hljs-string">&#x27;outputs/graph.graphml&#x27;</span>)<br><br><span class="hljs-comment"># 绘制图</span><br>nx.draw(G, with_labels=<span class="hljs-literal">True</span>, node_size=<span class="hljs-number">500</span>, node_color=<span class="hljs-string">&#x27;lightblue&#x27;</span>, font_size=<span class="hljs-number">10</span>, font_weight=<span class="hljs-string">&#x27;bold&#x27;</span>)<br><br><span class="hljs-comment"># 显示图</span><br>plt.show()<br></code></pre></td></tr></table></figure>

<p>绘制结果：</p>
<img src="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%E3%80%91hipporag-hipporag2/3.png" srcset="/img/loading.gif" lazyload class="">
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/" class="category-chain-item">代码复现</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/RAG/" class="print-no-link">#RAG</a>
      
        <a href="/tags/LLM/" class="print-no-link">#LLM</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>【论文复现】HippoRAG &amp; HippoRAG2</div>
      <div>http://xuan-van.github.io/代码复现/【论文复现】hipporag-hipporag2/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>文晋</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年3月27日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - 非商业性使用">
                    <i class="iconfont icon-cc-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%8E%B0/%E3%80%90%E6%A8%A1%E5%9E%8B%E5%A4%8D%E7%8E%B0%E3%80%91%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0-llama3/" title="【模型复现】从零实现 Llama3">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">【模型复现】从零实现 Llama3</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/%E6%96%B0%E6%89%8B%E5%85%A5%E9%97%A8/%E3%80%90%E5%8D%9A%E5%AE%A2%E5%85%A5%E9%97%A8%E3%80%91%E5%9F%BA%E4%BA%8E-hexo-%E7%9A%84%E4%B8%BB%E9%A2%98-fluid-%E6%90%AD%E5%BB%BA-github-%E5%8D%9A%E5%AE%A2/" title="【博客入门】基于 Hexo 的主题 Fluid 搭建 Github 博客">
                        <span class="hidden-mobile">【博客入门】基于 Hexo 的主题 Fluid 搭建 Github 博客</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/background/background.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/background/background.js"></script><!-- hexo injector body_end end --></body>
</html>
